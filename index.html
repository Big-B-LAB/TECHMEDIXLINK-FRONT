<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>TechMedixLink | Medical Technology Bridge Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ====== ENHANCED COLOR PALETTE & DESIGN ====== */
        :root {
            /* Enhanced Healthcare Palette */
            --primary-gradient: linear-gradient(135deg, #0066cc 0%, #00a3e0 100%);
            --secondary-gradient: linear-gradient(135deg, #00b3b3 0%, #00d4aa 100%);
            --accent-gradient: linear-gradient(135deg, #8a2be2 0%, #5d00ff 100%);
            --dark-gradient: linear-gradient(135deg, #0a192f 0%, #172a45 100%);
            
            /* Modern Neutrals */
            --dark-1: #0a192f;
            --dark-2: #172a45;
            --dark-3: #2d4263;
            --light-1: #f0f7ff;
            --light-2: #ffffff;
            
            /* Shadows */
            --shadow-soft: 0 4px 20px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.12);
            --shadow-strong: 0 15px 50px rgba(0, 0, 0, 0.15);
            
            /* Border Radius */
            --radius-big: 24px;
            --radius-medium: 16px;
            --radius-small: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--light-2);
            color: var(--dark-2);
            line-height: 1.6;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .text-gradient {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hidden {
            display: none !important;
        }

        /* ====== CREATIVE HEADER ====== */
        .creative-header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            padding: 1rem 0;
            transition: all 0.3s ease;
        }

        .header-scrolled {
            padding: 0.5rem 0;
            box-shadow: var(--shadow-medium);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--primary-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--light-2);
            box-shadow: var(--shadow-soft);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-main {
            font-family: 'Poppins', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark-1);
            letter-spacing: -0.5px;
        }

        .logo-tagline {
            font-size: 0.75rem;
            color: var(--dark-3);
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* ====== CREATIVE NAVIGATION ====== */
        .creative-nav ul {
            display: flex;
            gap: 0.5rem;
            list-style: none;
        }

        .creative-nav-link {
            padding: 0.75rem 1.5rem;
            color: var(--dark-2);
            text-decoration: none;
            border-radius: 50px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .creative-nav-link:hover {
            background: rgba(0, 102, 204, 0.05);
            color: var(--dark-1);
        }

        .creative-nav-link.active {
            background: var(--primary-gradient);
            color: var(--light-2);
            box-shadow: var(--shadow-soft);
        }

        /* ====== HERO SECTION ====== */
        .creative-hero {
            padding: 10rem 0 5rem;
            background: linear-gradient(135deg, #f0f7ff 0%, #e6f0ff 100%);
            position: relative;
            overflow: hidden;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1.1;
            margin-bottom: 1.5rem;
            color: var(--dark-1);
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: var(--dark-3);
            margin-bottom: 2.5rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 3rem;
        }

        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 3rem;
        }

        .hero-stat {
            background: var(--light-2);
            padding: 1.5rem;
            border-radius: var(--radius-big);
            text-align: center;
            box-shadow: var(--shadow-soft);
            transition: all 0.3s ease;
        }

        .hero-stat:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: var(--dark-3);
            font-weight: 500;
        }

        /* ====== BUTTONS ====== */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem 2rem;
            border-radius: var(--radius-medium);
            font-weight: 600;
            font-size: 1rem;
            text-decoration: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: var(--light-2);
            box-shadow: 0 4px 15px rgba(0, 102, 204, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 102, 204, 0.4);
        }

        .btn-secondary {
            background: var(--light-2);
            color: var(--dark-1);
            border: 2px solid var(--dark-1);
            box-shadow: var(--shadow-soft);
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        /* ====== DASHBOARD SECTIONS (Your Existing Layout) ====== */
        .main-content {
            padding: 2rem 0;
            min-height: 60vh;
        }

        .data-card {
            background: var(--light-2);
            border-radius: var(--radius-big);
            box-shadow: var(--shadow-soft);
            border: 1px solid rgba(0, 0, 0, 0.05);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .data-card-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .data-card-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .data-card-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--primary-gradient);
            color: var(--light-2);
            font-size: 1.25rem;
        }

        .data-card-body {
            padding: 1.5rem;
        }

        /* ====== FILTER BAR ====== */
        .filter-bar {
            background: var(--light-1);
            border-radius: var(--radius-medium);
            padding: 1rem;
            margin-bottom: 1rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex: 1;
            min-width: 200px;
        }

        .filter-label {
            font-weight: 500;
            color: var(--dark-2);
            white-space: nowrap;
        }

        .filter-select {
            padding: 0.75rem;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: var(--radius-small);
            background: var(--light-2);
            color: var(--dark-2);
            font-size: 0.875rem;
            flex: 1;
            min-width: 150px;
        }

        /* ====== TABLES ====== */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .data-table th {
            background: var(--light-1);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--dark-2);
            border-bottom: 2px solid rgba(0, 0, 0, 0.05);
        }

        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .data-table tr:hover {
            background: var(--light-1);
        }

        /* ====== FORMS ====== */
        .form-card {
            background: var(--light-2);
            border-radius: var(--radius-big);
            padding: 2rem;
            box-shadow: var(--shadow-soft);
            max-width: 800px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark-2);
        }

        .form-control {
            width: 100%;
            padding: 0.875rem;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: var(--radius-small);
            font-size: 1rem;
            color: var(--dark-2);
            background: var(--light-2);
        }

        .form-control:focus {
            outline: none;
            border-color: #0066cc;
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }

        /* ====== BADGES ====== */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-success {
            background: rgba(0, 204, 102, 0.1);
            color: #00cc66;
        }

        .badge-warning {
            background: rgba(255, 153, 0, 0.1);
            color: #ff9900;
        }

        .badge-info {
            background: rgba(0, 102, 204, 0.1);
            color: #0066cc;
        }

        /* ====== FOOTER ====== */
        .main-footer {
            background: var(--dark-gradient);
            color: var(--light-2);
            padding: 4rem 0 2rem;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-section h4 {
            color: var(--light-2);
            margin-bottom: 1.5rem;
            font-size: 1.125rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: color 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-links a:hover {
            color: var(--light-2);
        }

        .footer-bottom {
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 0.875rem;
        }

        /* ====== LOADING STATES ====== */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            color: var(--dark-3);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-top-color: #0066cc;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ====== RESPONSIVE DESIGN ====== */
        @media (max-width: 1024px) {
            .hero-title {
                font-size: 2.75rem;
            }
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.25rem;
            }
            
            .hero-actions {
                flex-direction: column;
            }
            
            .data-table {
                display: block;
                overflow-x: auto;
            }
            
            .creative-nav {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block;
            }
        }

        @media (max-width: 480px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="creative-header" id="mainHeader">
        <div class="container header-content">
            <a href="#" class="logo-container" onclick="showSection('hero')">
                <div class="logo-icon">
                    <i class="fas fa-bridge-medical"></i>
                </div>
                <div class="logo-text">
                    <div class="logo-main">TechMedixLink</div>
                    <div class="logo-tagline">Medical Technology Bridge</div>
                </div>
            </a>
            
            <button class="mobile-menu-btn" style="display: none; background: none; border: none; font-size: 1.5rem; color: var(--dark-1);">
                <i class="fas fa-bars"></i>
            </button>
            
            <nav class="creative-nav">
                <ul>
                    <li><a href="#" class="creative-nav-link" onclick="showSection('dashboard')"><i class="fas fa-chart-line"></i> Dashboard</a></li>
                    <li><a href="#" class="creative-nav-link" onclick="showSection('devices')"><i class="fas fa-stethoscope"></i> Devices</a></li>
                    <li><a href="#" class="creative-nav-link" onclick="showSection('providers')"><i class="fas fa-hospital"></i> Providers</a></li>
                    <li><a href="#" class="creative-nav-link" onclick="showSection('request')"><i class="fas fa-file-medical"></i> Request</a></li>
                    <li><a href="#" class="creative-nav-link btn-primary" onclick="showSection('request')"><i class="fas fa-rocket"></i> Get Started</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="hero" class="creative-hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">
                    Transforming Healthcare Through 
                    <span class="text-gradient">Medical Technology</span>
                </h1>
                <p class="hero-subtitle">
                    TechMedixLink bridges advanced medical technology with Tanzania's healthcare system. 
                    Strategic advisory, technology transfer, and digital solutions for healthcare transformation.
                </p>
                
                <div class="hero-actions">
                    <button class="btn btn-primary" onclick="showSection('request')">
                        <i class="fas fa-file-medical"></i> Submit Request
                    </button>
                    <button class="btn btn-secondary" onclick="showSection('dashboard')">
                        <i class="fas fa-chart-line"></i> View Dashboard
                    </button>
                </div>
                
                <div class="hero-stats">
                    <div class="hero-stat">
                        <div class="stat-number" id="heroDevices">0</div>
                        <div class="stat-label">Medical Devices</div>
                    </div>
                    <div class="hero-stat">
                        <div class="stat-number" id="heroProviders">0</div>
                        <div class="stat-label">Healthcare Providers</div>
                    </div>
                    <div class="hero-stat">
                        <div class="stat-number" id="heroCertified">0</div>
                        <div class="stat-label">TMDA Certified</div>
                    </div>
                    <div class="hero-stat">
                        <div class="stat-number" id="heroRequests">0</div>
                        <div class="stat-label">Active Requests</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content (Your Existing Dashboard Sections) -->
    <main class="main-content">
        <div class="container">
            <!-- Dashboard Section -->
            <section id="dashboard" class="hidden">
                <h2 class="mb-4">Platform Dashboard</h2>
                
                <!-- Stats Grid -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <div class="hero-stat">
                        <div class="stat-number" id="statDevices">0</div>
                        <div class="stat-label">Medical Devices</div>
                        <div class="text-muted" style="font-size: 0.875rem; margin-top: 0.5rem;" id="deviceTrend">Loading...</div>
                    </div>
                    
                    <div class="hero-stat">
                        <div class="stat-number" id="statProviders">0</div>
                        <div class="stat-label">Healthcare Providers</div>
                        <div class="text-muted" style="font-size: 0.875rem; margin-top: 0.5rem;" id="providerTrend">Loading...</div>
                    </div>
                    
                    <div class="hero-stat">
                        <div class="stat-number" id="statCertified">0</div>
                        <div class="stat-label">TMDA Certified</div>
                        <div class="text-muted" style="font-size: 0.875rem; margin-top: 0.5rem;" id="certifiedTrend">Loading...</div>
                    </div>
                    
                    <div class="hero-stat">
                        <div class="stat-number" id="statLocalSupport">0</div>
                        <div class="stat-label">Local Support Available</div>
                        <div class="text-muted" style="font-size: 0.875rem; margin-top: 0.5rem;" id="supportTrend">Loading...</div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="data-card">
                    <div class="data-card-header">
                        <div class="data-card-title">
                            <div class="data-card-icon">
                                <i class="fas fa-history"></i>
                            </div>
                            <div>
                                <h3>Recent Medical Devices</h3>
                                <p style="color: var(--dark-3); font-size: 0.875rem;">Latest additions to the medical technology catalog</p>
                            </div>
                        </div>
                        <div>
                            <button class="btn btn-secondary" onclick="loadDevices()" style="padding: 0.75rem 1.5rem; font-size: 0.875rem;">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    <div class="data-card-body">
                        <div id="recentDevices" class="loading">
                            <div class="loading-spinner"></div>
                            <p>Loading recent devices...</p>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="data-card">
                    <div class="data-card-header">
                        <div class="data-card-title">
                            <div class="data-card-icon">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div>
                                <h3>Quick Actions</h3>
                                <p style="color: var(--dark-3); font-size: 0.875rem;">Common platform operations</p>
                            </div>
                        </div>
                    </div>
                    <div class="data-card-body">
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="showSection('request')">
                                <i class="fas fa-plus"></i> Add New Request
                            </button>
                            <button class="btn btn-secondary" onclick="showModal('device')">
                                <i class="fas fa-plus"></i> Add New Device
                            </button>
                            <button class="btn" onclick="showModal('provider')" style="background: var(--secondary-gradient); color: white;">
                                <i class="fas fa-plus"></i> Add New Provider
                            </button>
                            <button class="btn btn-secondary" onclick="loadAllData()">
                                <i class="fas fa-sync-alt"></i> Refresh All Data
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Medical Devices Section -->
            <section id="devices" class="hidden">
                <div class="data-card">
                    <div class="data-card-header">
                        <div class="data-card-title">
                            <div class="data-card-icon">
                                <i class="fas fa-stethoscope"></i>
                            </div>
                            <div>
                                <h3>Medical Devices Catalog</h3>
                                <p style="color: var(--dark-3); font-size: 0.875rem;">Advanced medical technology available for Tanzanian healthcare</p>
                            </div>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-primary" onclick="showSection('request')" style="padding: 0.75rem 1.5rem; font-size: 0.875rem;">
                                <i class="fas fa-file-medical"></i> Request Device
                            </button>
                            <button class="btn btn-secondary" onclick="showModal('device')" style="padding: 0.75rem 1.5rem; font-size: 0.875rem;">
                                <i class="fas fa-plus"></i> Add New Device
                            </button>
                        </div>
                    </div>
                    
                    <!-- Filter Bar -->
                    <div class="filter-bar">
                        <div class="filter-group">
                            <span class="filter-label">Filter by:</span>
                            <select id="deviceFilter" class="filter-select" onchange="filterDevices()">
                                <option value="all">All Devices</option>
                                <option value="certified">TMDA Certified Only</option>
                                <option value="local">Local Support Available</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">Sort by:</span>
                            <select id="deviceSort" class="filter-select" onchange="sortDevices()">
                                <option value="name">Device Name</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                                <option value="certified">Certification Status</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-secondary" onclick="resetFilters()" style="padding: 0.75rem 1.5rem; font-size: 0.875rem; width: 100%;">
                                <i class="fas fa-redo"></i> Reset Filters
                            </button>
                        </div>
                    </div>
                    
                    <div class="data-card-body">
                        <div id="devicesList" class="loading">
                            <div class="loading-spinner"></div>
                            <p>Loading medical devices from API...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Healthcare Providers Section -->
            <section id="providers" class="hidden">
                <div class="data-card">
                    <div class="data-card-header">
                        <div class="data-card-title">
                            <div class="data-card-icon">
                                <i class="fas fa-hospital"></i>
                            </div>
                            <div>
                                <h3>Healthcare Providers Network</h3>
                                <p style="color: var(--dark-3); font-size: 0.875rem;">Tanzanian healthcare facilities participating in the TechMedixLink platform</p>
                            </div>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button class="btn btn-secondary" onclick="exportProviders()" style="padding: 0.75rem 1.5rem; font-size: 0.875rem;">
                                <i class="fas fa-download"></i> Export List
                            </button>
                            <button class="btn btn-primary" onclick="showModal('provider')" style="padding: 0.75rem 1.5rem; font-size: 0.875rem;">
                                <i class="fas fa-plus"></i> Add New Provider
                            </button>
                        </div>
                    </div>
                    
                    <!-- Filter Bar -->
                    <div class="filter-bar">
                        <div class="filter-group">
                            <span class="filter-label">Region:</span>
                            <select id="regionFilter" class="filter-select" onchange="filterProviders()">
                                <option value="all">All Regions</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">Facility Type:</span>
                            <select id="facilityFilter" class="filter-select" onchange="filterProviders()">
                                <option value="all">All Types</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <button class="btn btn-secondary" onclick="resetProviderFilters()" style="padding: 0.75rem 1.5rem; font-size: 0.875rem; width: 100%;">
                                <i class="fas fa-redo"></i> Reset Filters
                            </button>
                        </div>
                    </div>
                    
                    <div class="data-card-body">
                        <div id="providersList" class="loading">
                            <div class="loading-spinner"></div>
                            <p>Loading healthcare providers from API...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Submit Request Section -->
            <section id="request" class="hidden">
                <div class="form-card">
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <div style="width: 60px; height: 60px; background: var(--primary-gradient); border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; margin: 0 auto 1rem;">
                            <i class="fas fa-file-medical"></i>
                        </div>
                        <h2>Medical Technology Request Form</h2>
                        <p style="color: var(--dark-3); margin-top: 0.5rem;">Submit your request for medical equipment or technology consultation</p>
                    </div>
                    
                    <div class="message hidden" id="requestMessage" style="padding: 1rem; border-radius: var(--radius-small); margin-bottom: 1.5rem;"></div>
                    
                    <form id="requestForm" onsubmit="submitRequest(event)">
                        <div class="form-group">
                            <label for="providerSelect" class="form-label">
                                <i class="fas fa-hospital"></i> Healthcare Facility *
                            </label>
                            <select id="providerSelect" class="form-control" required>
                                <option value="">Select your hospital or clinic</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="deviceSelect" class="form-label">
                                <i class="fas fa-stethoscope"></i> Medical Technology Requested *
                            </label>
                            <select id="deviceSelect" class="form-control" required>
                                <option value="">Select medical device or technology</option>
                            </select>
                            <div style="margin-top: 0.5rem;" id="deviceDetails"></div>
                        </div>

                        <div class="form-group">
                            <label for="quantity" class="form-label">
                                <i class="fas fa-boxes"></i> Quantity Needed *
                            </label>
                            <input type="number" id="quantity" class="form-control" min="1" max="100" value="1" required>
                        </div>

                        <div class="form-group">
                            <label for="urgency" class="form-label">
                                <i class="fas fa-clock"></i> Urgency Level
                            </label>
                            <select id="urgency" class="form-control">
                                <option value="normal">Normal Priority</option>
                                <option value="high">High Priority</option>
                                <option value="urgent">Urgent - Critical Need</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="notes" class="form-label">
                                <i class="fas fa-notes-medical"></i> Additional Requirements
                            </label>
                            <textarea id="notes" class="form-control" rows="4" 
                                      placeholder="Please provide specific requirements, installation needs, training requirements, or any other details..."></textarea>
                        </div>

                        <div class="form-group">
                            <div style="background: rgba(0, 102, 204, 0.05); padding: 1rem; border-radius: var(--radius-small); color: var(--dark-3);">
                                <i class="fas fa-info-circle"></i> After submission, our team will contact you within 24 hours to discuss the next steps.
                            </div>
                        </div>

                        <div class="form-group" style="display: flex; gap: 1rem; margin-top: 2rem;">
                            <button type="submit" class="btn btn-primary" style="flex: 1;">
                                <i class="fas fa-paper-plane"></i> Submit Request
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetForm()">
                                <i class="fas fa-redo"></i> Reset
                            </button>
                        </div>
                    </form>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-grid">
                <div>
                    <h4>TechMedixLink</h4>
                    <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 1.5rem;">
                        Bridging medical technology between developed nations and Tanzania's healthcare system.
                    </p>
                    <div style="display: flex; gap: 1rem;">
                        <a href="#" style="color: rgba(255, 255, 255, 0.7);"><i class="fab fa-twitter"></i></a>
                        <a href="#" style="color: rgba(255, 255, 255, 0.7);"><i class="fab fa-linkedin"></i></a>
                        <a href="#" style="color: rgba(255, 255, 255, 0.7);"><i class="fab fa-github"></i></a>
                    </div>
                </div>
                
                <div>
                    <h4>Platform</h4>
                    <ul class="footer-links">
                        <li><a href="#" onclick="showSection('dashboard')"><i class="fas fa-arrow-right"></i> Dashboard</a></li>
                        <li><a href="#" onclick="showSection('devices')"><i class="fas fa-arrow-right"></i> Medical Devices</a></li>
                        <li><a href="#" onclick="showSection('providers')"><i class="fas fa-arrow-right"></i> Healthcare Providers</a></li>
                        <li><a href="#" onclick="showSection('request')"><i class="fas fa-arrow-right"></i> Submit Request</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4>Technology</h4>
                    <ul class="footer-links">
                        <li><i class="fas fa-server"></i> Backend: Railway</li>
                        <li><i class="fas fa-database"></i> Database: Supabase</li>
                        <li><i class="fas fa-code"></i> API Status: <span id="footerStatus">Checking...</span></li>
                        <li><i class="fas fa-shield-alt"></i> Data Security: HIPAA Compliant</li>
                    </ul>
                </div>
                
                <div>
                    <h4>Contact</h4>
                    <ul class="footer-links">
                        <li><a href="mailto:info@techmedixlink.tz"><i class="fas fa-envelope"></i> info@techmedixlink.tz</a></li>
                        <li><a href="tel:+255222000000"><i class="fas fa-phone"></i> +255 22 200 0000</a></li>
                        <li><i class="fas fa-map-marker-alt"></i> Dar es Salaam, Tanzania</li>
                        <li><a href="#"><i class="fas fa-file-alt"></i> Privacy Policy</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>Â© 2024 TechMedixLink - Medical Technology Bridge Platform for Tanzania.</p>
                <p style="margin-top: 0.5rem; color: rgba(255, 255, 255, 0.5); font-size: 0.75rem;">
                    This platform connects Tanzanian healthcare providers with international medical technology solutions.
                </p>
            </div>
        </div>
    </footer>

    <!-- Device Modal -->
    <div class="modal-overlay hidden" id="deviceModal">
        <div class="modal" style="background: var(--light-2); border-radius: var(--radius-big); padding: 2rem; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 id="deviceModalTitle">Add New Medical Device</h3>
                <button onclick="closeModal('device')" style="background: none; border: none; font-size: 1.5rem; color: var(--dark-3); cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="deviceForm" onsubmit="saveDevice(event)">
                <input type="hidden" id="deviceId">
                <div class="form-group">
                    <label for="deviceName" class="form-label">Device Name *</label>
                    <input type="text" id="deviceName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="deviceManufacturer" class="form-label">Manufacturer *</label>
                    <input type="text" id="deviceManufacturer" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="deviceType" class="form-label">Device Type *</label>
                    <select id="deviceType" class="form-control" required>
                        <option value="">Select type</option>
                        <option value="Diagnostic">Diagnostic Equipment</option>
                        <option value="Therapeutic">Therapeutic Equipment</option>
                        <option value="Monitoring">Patient Monitoring</option>
                        <option value="Surgical">Surgical Equipment</option>
                        <option value="Laboratory">Laboratory Equipment</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="devicePrice" class="form-label">Price (USD) *</label>
                    <input type="number" id="devicePrice" class="form-control" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="deviceDescription" class="form-label">Description</label>
                    <textarea id="deviceDescription" class="form-control" rows="3"></textarea>
                </div>
                <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label" style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="deviceCertified" style="width: auto;">
                            TMDA Certified
                        </label>
                    </div>
                    <div class="form-group" style="flex: 1;">
                        <label class="form-label" style="display: flex; align-items: center; gap: 0.5rem;">
                            <input type="checkbox" id="deviceLocalSupport" style="width: auto;">
                            Local Support Available
                        </label>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="submit" class="btn btn-primary">Save Device</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('device')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Provider Modal -->
    <div class="modal-overlay hidden" id="providerModal">
        <div class="modal" style="background: var(--light-2); border-radius: var(--radius-big); padding: 2rem; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 id="providerModalTitle">Add New Healthcare Provider</h3>
                <button onclick="closeModal('provider')" style="background: none; border: none; font-size: 1.5rem; color: var(--dark-3); cursor: pointer;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="providerForm" onsubmit="saveProvider(event)">
                <input type="hidden" id="providerId">
                <div class="form-group">
                    <label for="providerName" class="form-label">Facility Name *</label>
                    <input type="text" id="providerName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="providerType" class="form-label">Facility Type *</label>
                    <select id="providerType" class="form-control" required>
                        <option value="">Select type</option>
                        <option value="Hospital">Hospital</option>
                        <option value="Clinic">Clinic</option>
                        <option value="Referral Hospital">Referral Hospital</option>
                        <option value="Private Hospital">Private Hospital</option>
                        <option value="Health Center">Health Center</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="providerRegion" class="form-label">Region *</label>
                    <select id="providerRegion" class="form-control" required>
                        <option value="">Select region</option>
                        <option value="Dar es Salaam">Dar es Salaam</option>
                        <option value="Kilimanjaro">Kilimanjaro</option>
                        <option value="Mbeya">Mbeya</option>
                        <option value="Mwanza">Mwanza</option>
                        <option value="Tanga">Tanga</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="providerLocation" class="form-label">Location *</label>
                    <input type="text" id="providerLocation" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="providerContact" class="form-label">Contact Person</label>
                    <input type="text" id="providerContact" class="form-control">
                </div>
                <div class="form-group">
                    <label for="providerPhone" class="form-label">Phone Number</label>
                    <input type="tel" id="providerPhone" class="form-control">
                </div>
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="submit" class="btn btn-primary" style="background: var(--secondary-gradient);">Save Provider</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('provider')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Overlay Background -->
    <div class="modal-overlay hidden" id="modalOverlay" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 2000; display: flex; align-items: center; justify-content: center; padding: 1rem;"></div>

    <script>
        // ====== API CONFIGURATION ======
        const API_BASE_URL = 'https://techmedixlink-api-production.up.railway.app';
        let allDevices = [];
        let allProviders = [];

        // ====== ENHANCED UI FUNCTIONS ======
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('section[id]').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Update active nav link
            document.querySelectorAll('.creative-nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            if (sectionId !== 'hero') {
                const activeLink = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
                if (activeLink) activeLink.classList.add('active');
            } else {
                // Reset header style when showing hero
                document.getElementById('mainHeader').classList.remove('header-scrolled');
            }
            
            // Load data for the section if needed
            if (sectionId === 'devices') {
                loadDevices();
            } else if (sectionId === 'providers') {
                loadProviders();
            } else if (sectionId === 'request') {
                loadFormData();
            }
            
            // Scroll to top of section
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showModal(type) {
            const modal = document.getElementById(`${type}Modal`);
            const overlay = document.getElementById('modalOverlay');
            
            if (modal && overlay) {
                modal.classList.remove('hidden');
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(type) {
            const modal = document.getElementById(`${type}Modal`);
            const overlay = document.getElementById('modalOverlay');
            
            if (modal && overlay) {
                modal.classList.add('hidden');
                overlay.classList.add('hidden');
                document.body.style.overflow = '';
                
                // Reset form if needed
                if (type === 'device') {
                    document.getElementById('deviceForm').reset();
                    document.getElementById('deviceId').value = '';
                    document.getElementById('deviceModalTitle').textContent = 'Add New Medical Device';
                } else if (type === 'provider') {
                    document.getElementById('providerForm').reset();
                    document.getElementById('providerId').value = '';
                    document.getElementById('providerModalTitle').textContent = 'Add New Healthcare Provider';
                }
            }
        }

        // Close modal when clicking overlay
        document.getElementById('modalOverlay').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal('device');
                closeModal('provider');
            }
        });

        // ====== YOUR EXISTING API FUNCTIONS ======
        async function loadAllData() {
            try {
                await Promise.all([loadDevices(), loadProviders()]);
                updateDashboardStats();
                showToast('Data refreshed successfully', 'success');
            } catch (error) {
                console.error('Error loading data:', error);
                showToast('Failed to refresh data. Please check API connection.', 'error');
            }
        }

        async function loadDevices() {
            const container = document.getElementById('devicesList');
            const recentContainer = document.getElementById('recentDevices');
            
            // Show loading state
            if (container) container.innerHTML = '<div class="loading"><div class="loading-spinner"></div><p>Loading medical devices...</p></div>';
            if (recentContainer) recentContainer.innerHTML = '<div class="loading"><div class="loading-spinner"></div><p>Loading recent devices...</p></div>';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/devices`);
                if (!response.ok) throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                
                const data = await response.json();
                
                if (data.success) {
                    allDevices = data.devices || [];
                    displayDevices(allDevices);
                    updateDeviceSelect(allDevices);
                    updateDashboardStats();
                    
                    // Update recent devices
                    updateRecentDevices(allDevices.slice(0, 3));
                } else {
                    throw new Error(data.error || 'Failed to fetch devices');
                }
            } catch (error) {
                console.error('Error loading devices:', error);
                const errorHtml = '<div class="message" style="background: rgba(255, 68, 68, 0.1); color: #ff4444; padding: 1rem; border-radius: var(--radius-small);"><i class="fas fa-exclamation-circle"></i> Error loading devices: ' + error.message + '</div>';
                if (container) container.innerHTML = errorHtml;
                if (recentContainer) container.innerHTML = errorHtml;
            }
        }

        function displayDevices(devices) {
            const container = document.getElementById('devicesList');
            
            if (!devices || devices.length === 0) {
                container.innerHTML = '<div class="message" style="background: rgba(0, 102, 204, 0.1); color: #0066cc; padding: 1rem; border-radius: var(--radius-small);"><i class="fas fa-info-circle"></i> No medical devices found. Add your first device!</div>';
                return;
            }
            
            let html = `
                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Device</th>
                                <th>Manufacturer</th>
                                <th>Type</th>
                                <th>Price (USD)</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            devices.forEach(device => {
                html += `
                    <tr>
                        <td>
                            <div style="font-weight: 600;">${escapeHtml(device.name)}</div>
                            <div style="color: var(--dark-3); font-size: 0.875rem;">${device.description ? escapeHtml(device.description.substring(0, 50)) + '...' : 'No description'}</div>
                        </td>
                        <td>${escapeHtml(device.manufacturer)}</td>
                        <td><span class="badge badge-info">${escapeHtml(device.device_type)}</span></td>
                        <td><strong>$${device.price_usd?.toLocaleString() || '0'}</strong></td>
                        <td>
                            ${device.tz_certified ? 
                                '<span class="badge badge-success"><i class="fas fa-check"></i> Certified</span>' : 
                                '<span class="badge badge-warning"><i class="fas fa-clock"></i> Pending</span>'}
                            ${device.local_support ? 
                                '<span class="badge badge-success" style="display: block; margin-top: 0.25rem;"><i class="fas fa-check"></i> Local Support</span>' : 
                                '<span class="badge badge-warning" style="display: block; margin-top: 0.25rem;"><i class="fas fa-times"></i> No Support</span>'}
                        </td>
                        <td>
                            <div style="display: flex; gap: 0.5rem;">
                                <button onclick="editDevice('${device.id}')" style="background: none; border: none; color: var(--dark-3); cursor: pointer; padding: 0.5rem; border-radius: var(--radius-small);" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="deleteDevice('${device.id}')" style="background: none; border: none; color: var(--dark-3); cursor: pointer; padding: 0.5rem; border-radius: var(--radius-small);" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                                <button onclick="requestDevice('${device.id}')" style="background: none; border: none; color: var(--dark-3); cursor: pointer; padding: 0.5rem; border-radius: var(--radius-small);" title="Request">
                                    <i class="fas fa-file-medical"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table></div>';
            container.innerHTML = html;
        }

        function updateRecentDevices(devices) {
            const container = document.getElementById('recentDevices');
            
            if (!devices || devices.length === 0) {
                container.innerHTML = '<div class="message" style="background: rgba(0, 102, 204, 0.1); color: #0066cc; padding: 1rem; border-radius: var(--radius-small);"><i class="fas fa-info-circle"></i> No recent devices available</div>';
                return;
            }
            
            let html = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Device</th>
                            <th>Manufacturer</th>
                            <th>Price</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            devices.forEach(device => {
                html += `
                    <tr>
                        <td><strong>${escapeHtml(device.name)}</strong></td>
                        <td>${escapeHtml(device.manufacturer)}</td>
                        <td>$${device.price_usd?.toLocaleString() || '0'}</td>
                        <td>${device.tz_certified ? 
                            '<span class="badge badge-success">Certified</span>' : 
                            '<span class="badge badge-warning">Pending</span>'}</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }

        // ====== ENHANCED HELPER FUNCTIONS ======
        function updateDashboardStats() {
            // Update hero stats
            document.getElementById('heroDevices').textContent = allDevices.length;
            document.getElementById('heroProviders').textContent = allProviders.length;
            
            const certifiedCount = allDevices.filter(d => d.tz_certified).length;
            document.getElementById('heroCertified').textContent = certifiedCount;
            
            // Update dashboard stats
            document.getElementById('statDevices').textContent = allDevices.length;
            document.getElementById('statProviders').textContent = allProviders.length;
            document.getElementById('statCertified').textContent = certifiedCount;
            
            const localSupportCount = allDevices.filter(d => d.local_support).length;
            document.getElementById('statLocalSupport').textContent = localSupportCount;
            
            // Update trends
            document.getElementById('deviceTrend').textContent = `${allDevices.length} total`;
            document.getElementById('providerTrend').textContent = `${allProviders.length} total`;
            document.getElementById('certifiedTrend').textContent = certifiedCount > 0 ? `${Math.round((certifiedCount / allDevices.length) * 100)}% certified` : 'None certified';
            document.getElementById('supportTrend').textContent = localSupportCount > 0 ? `${Math.round((localSupportCount / allDevices.length) * 100)}% with support` : 'No support';
        }

        function showToast(message, type) {
            const toast = document.createElement('div');
            toast.className = `toast message-${type}`;
            toast.innerHTML = type === 'success' 
                ? `<i class="fas fa-check-circle"></i> ${message}`
                : `<i class="fas fa-exclamation-circle"></i> ${message}`;
            
            toast.style.cssText = `
                position: fixed;
                top: 1rem;
                right: 1rem;
                padding: 1rem 1.5rem;
                border-radius: var(--radius-medium);
                background: ${type === 'success' ? 'rgba(0, 204, 102, 0.9)' : 'rgba(255, 68, 68, 0.9)'};
                color: white;
                z-index: 3000;
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ====== EXISTING FUNCTIONS FROM YOUR CODE ======
        async function loadProviders() {
            const container = document.getElementById('providersList');
            container.innerHTML = '<div class="loading"><div class="loading-spinner"></div><p>Loading healthcare providers...</p></div>';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/providers`);
                if (!response.ok) throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                
                const data = await response.json();
                
                if (data.success) {
                    allProviders = data.providers || [];
                    displayProviders(allProviders);
                    updateProviderSelect(allProviders);
                    updateDashboardStats();
                } else {
                    throw new Error(data.error || 'Failed to fetch providers');
                }
            } catch (error) {
                console.error('Error loading providers:', error);
                container.innerHTML = '<div class="message" style="background: rgba(255, 68, 68, 0.1); color: #ff4444; padding: 1rem; border-radius: var(--radius-small);"><i class="fas fa-exclamation-circle"></i> Error loading providers: ' + error.message + '</div>';
            }
        }

        async function saveDevice(event) {
            event.preventDefault();
            
            const deviceData = {
                name: document.getElementById('deviceName').value,
                manufacturer: document.getElementById('deviceManufacturer').value,
                device_type: document.getElementById('deviceType').value,
                price_usd: parseFloat(document.getElementById('devicePrice').value),
                description: document.getElementById('deviceDescription').value,
                tz_certified: document.getElementById('deviceCertified').checked,
                local_support: document.getElementById('deviceLocalSupport').checked
            };

            const deviceId = document.getElementById('deviceId').value;
            const isEdit = deviceId && deviceId !== '';

            try {
                const url = isEdit ? 
                    `${API_BASE_URL}/api/devices/${deviceId}` : 
                    `${API_BASE_URL}/api/devices`;
                
                const method = isEdit ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(deviceData)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to save device');
                }

                const result = await response.json();
                
                if (result.success) {
                    closeModal('device');
                    showToast(isEdit ? 'Device updated successfully' : 'Device added successfully', 'success');
                    loadDevices();
                } else {
                    throw new Error(result.error || 'Failed to save device');
                }
            } catch (error) {
                console.error('Error saving device:', error);
                showToast('Error saving device: ' + error.message, 'error');
            }
        }

        async function deleteDevice(deviceId) {
            if (!confirm('Are you sure you want to delete this device?')) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/devices/${deviceId}`, {
                    method: 'DELETE'
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'Failed to delete device');
                }

                const result = await response.json();
                
                if (result.success) {
                    showToast('Device deleted successfully', 'success');
                    loadDevices();
                } else {
                    throw new Error(result.error || 'Failed to delete device');
                }
            } catch (error) {
                console.error('Error deleting device:', error);
                showToast('Error deleting device: ' + error.message, 'error');
            }
        }

        function editDevice(deviceId) {
            const device = allDevices.find(d => d.id === deviceId);
            if (!device) return;

            document.getElementById('deviceModalTitle').textContent = 'Edit Medical Device';
            document.getElementById('deviceId').value = device.id;
            document.getElementById('deviceName').value = device.name;
            document.getElementById('deviceManufacturer').value = device.manufacturer;
            document.getElementById('deviceType').value = device.device_type;
            document.getElementById('devicePrice').value = device.price_usd;
            document.getElementById('deviceDescription').value = device.description || '';
            document.getElementById('deviceCertified').checked = device.tz_certified || false;
            document.getElementById('deviceLocalSupport').checked = device.local_support || false;

            showModal('device');
        }

        // ====== INITIALIZATION ======
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboardStats();
            loadAllData();
            showSection('hero');
            checkApiStatus();
            
            // Set up auto-refresh every 5 minutes
            setInterval(() => {
                if (!document.hidden) {
                    loadAllData();
                }
            }, 300000);
            
            // Header scroll effect
            window.addEventListener('scroll', function() {
                const header = document.getElementById('mainHeader');
                if (window.scrollY > 50) {
                    header.classList.add('header-scrolled');
                } else {
                    header.classList.remove('header-scrolled');
                }
            });
        });

        // Check API status
        async function checkApiStatus() {
            const statusElement = document.getElementById('footerStatus');
            try {
                const response = await fetch(`${API_BASE_URL}/api/health`);
                if (response.ok) {
                    const data = await response.json();
                    statusElement.textContent = 'Online';
                    statusElement.style.color = '#00cc66';
                } else {
                    throw new Error('API not responding');
                }
            } catch (error) {
                console.error('API status check failed:', error);
                statusElement.textContent = 'Offline';
                statusElement.style.color = '#ff4444';
            }
        }

        // Escape HTML function
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ====== ADDITIONAL EXISTING FUNCTIONS ======
        // These are placeholders - add your existing functions here
        function filterDevices() { /* Your existing filter logic */ }
        function sortDevices() { /* Your existing sort logic */ }
        function resetFilters() { /* Your existing reset logic */ }
        function filterProviders() { /* Your existing filter logic */ }
        function resetProviderFilters() { /* Your existing reset logic */ }
        function exportProviders() { /* Your existing export logic */ }
        function saveProvider() { /* Your existing save provider logic */ }
        function updateDeviceSelect() { /* Your existing update logic */ }
        function updateProviderSelect() { /* Your existing update logic */ }
        function loadFormData() { /* Your existing load form data logic */ }
        function submitRequest() { /* Your existing submit request logic */ }
        function resetForm() { /* Your existing reset form logic */ }
        function requestDevice() { /* Your existing request device logic */ }
    </script>
</body>
</html>
